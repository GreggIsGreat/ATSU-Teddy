<!DOCTYPE html>
{% load static %}
{% include 'atsu_app/navbar.html' %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}ATSU - CV Analysis{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/cv_analysis.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
{% block content %}

<div class="analysis-container">
    <!-- Header Section -->
    <div class="analysis-header">
        <div class="header-left">
            <h1><i class="bi bi-file-earmark-check"></i> CV Analysis Report</h1>
            <p class="job-title-display">{{ job_title|default:"Software Developer" }}</p>
        </div>
        <div class="header-right">
            <button class="btn-export" onclick="exportReport()">
                <i class="bi bi-download"></i> Export PDF
            </button>
            <button class="btn-reanalyze" onclick="reanalyze()">
                <i class="bi bi-arrow-repeat"></i> Re-analyze
            </button>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="analysis-main">
        <!-- Left Panel - CV with Highlights -->
        <div class="panel cv-panel">
            <div class="panel-header">
                <div class="panel-tabs">
                    <button class="tab-btn active" data-tab="cv">
                        <i class="bi bi-file-person"></i> Your CV
                    </button>
                    <button class="tab-btn" data-tab="optimized">
                        <i class="bi bi-magic"></i> Optimized Version
                    </button>
                </div>
                <div class="panel-actions">
                    <button class="icon-btn" title="Zoom In" onclick="zoomIn()">
                        <i class="bi bi-zoom-in"></i>
                    </button>
                    <button class="icon-btn" title="Zoom Out" onclick="zoomOut()">
                        <i class="bi bi-zoom-out"></i>
                    </button>
                </div>
            </div>

            <div class="panel-content" id="cvContent">
                <!-- CV Tab Content -->
                <div class="tab-content active" id="cv-tab">
                    <div class="cv-document" id="cvDocument">
                        <!-- CV content with highlighted sections -->
                        <div class="cv-section">
                            <h3 class="cv-name">{{ user_name|default:"John Doe" }}</h3>
                            <p class="cv-contact">{{ user_email|default:"john@email.com" }} | {{ user_phone|default:"+267 71 234 567" }}</p>
                        </div>

                        <div class="cv-section">
                            <h4>Professional Summary</h4>
                            <p class="highlight-critical" data-suggestion="Add quantifiable achievements and specific technologies">
                                Experienced software developer with 5 years of experience in web development.
                                <span class="highlight-marker critical"><i class="bi bi-exclamation-circle"></i></span>
                            </p>
                        </div>

                        <div class="cv-section">
                            <h4>Skills</h4>
                            <p class="highlight-warning" data-suggestion="Add Python and Django as mentioned in job description">
                                JavaScript, React, HTML, CSS, Node.js
                                <span class="highlight-marker warning"><i class="bi bi-exclamation-triangle"></i></span>
                            </p>
                        </div>

                        <div class="cv-section">
                            <h4>Experience</h4>
                            <div class="experience-item">
                                <p class="highlight-success" data-suggestion="Great! This aligns well with the job requirements">
                                    <strong>Senior Developer</strong> - Tech Company (2020-Present)
                                    <span class="highlight-marker success"><i class="bi bi-check-circle"></i></span>
                                </p>
                                <ul>
                                    <li class="highlight-critical" data-suggestion="Add specific metrics: 'Increased performance by X%'">
                                        Developed web applications
                                        <span class="highlight-marker critical"><i class="bi bi-exclamation-circle"></i></span>
                                    </li>
                                    <li class="highlight-warning" data-suggestion="Mention team size and leadership experience">
                                        Led development team
                                        <span class="highlight-marker warning"><i class="bi bi-exclamation-triangle"></i></span>
                                    </li>
                                    <li>Implemented CI/CD pipelines</li>
                                </ul>
                            </div>
                        </div>

                        <div class="cv-section">
                            <h4>Education</h4>
                            <p>BSc Computer Science - University of Botswana (2018)</p>
                        </div>
                    </div>
                </div>

                <!-- Optimized Version Tab -->
                <div class="tab-content" id="optimized-tab">
                    <div class="cv-document optimized">
                        <div class="optimized-badge">
                            <i class="bi bi-stars"></i> AI-Optimized Version
                        </div>

                        <div class="cv-section">
                            <h3 class="cv-name">{{ user_name|default:"John Doe" }}</h3>
                            <p class="cv-contact">{{ user_email|default:"john@email.com" }} | {{ user_phone|default:"+267 71 234 567" }}</p>
                        </div>

                        <div class="cv-section">
                            <h4>Professional Summary</h4>
                            <p class="improved-text">
                                Results-driven software developer with <strong>5+ years</strong> of experience building scalable web applications using <strong>React, Node.js, and Python</strong>. Delivered projects that <strong>improved user engagement by 40%</strong> and <strong>reduced load times by 60%</strong>.
                            </p>
                        </div>

                        <div class="cv-section">
                            <h4>Technical Skills</h4>
                            <p class="improved-text">
                                <strong>Frontend:</strong> JavaScript, React, TypeScript, HTML5, CSS3<br>
                                <strong>Backend:</strong> Python, Django, Node.js, REST APIs<br>
                                <strong>Tools:</strong> Git, Docker, AWS, CI/CD
                            </p>
                        </div>
                        <!-- More optimized content -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Job Description & Analysis -->
        <div class="panel analysis-panel">
            <div class="panel-header">
                <div class="panel-tabs">
                    <button class="tab-btn active" data-tab="score">
                        <i class="bi bi-speedometer2"></i> Score
                    </button>
                    <button class="tab-btn" data-tab="job">
                        <i class="bi bi-briefcase"></i> Job Description
                    </button>
                    <button class="tab-btn" data-tab="improvements">
                        <i class="bi bi-list-check"></i> Improvements
                    </button>
                </div>
            </div>

            <div class="panel-content">
                <!-- Score Tab -->
                <div class="tab-content active" id="score-tab">
                    <!-- Hireability Score Circle -->
                    <div class="score-section">
                        <div class="score-circle-container">
                            <div class="score-circle" data-score="67">
                                <svg viewBox="0 0 100 100">
                                    <circle class="score-bg" cx="50" cy="50" r="45"></circle>
                                    <circle class="score-progress" cx="50" cy="50" r="45"
                                            stroke-dasharray="283"
                                            stroke-dashoffset="93"></circle>
                                </svg>
                                <div class="score-value">
                                    <span class="score-number">67</span>
                                    <span class="score-label">Hireability</span>
                                </div>
                            </div>
                        </div>
                        <div class="score-status warning">
                            <i class="bi bi-exclamation-triangle-fill"></i>
                            <span>Needs Improvement</span>
                        </div>
                    </div>

                    <!-- Score Breakdown -->
                    <div class="score-breakdown">
                        <h4>Score Breakdown</h4>

                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="breakdown-label">
                                    <i class="bi bi-bullseye"></i> Keyword Match
                                </span>
                                <span class="breakdown-score">45%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill critical" style="width: 45%"></div>
                            </div>
                        </div>

                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="breakdown-label">
                                    <i class="bi bi-gear"></i> Skills Match
                                </span>
                                <span class="breakdown-score">72%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill warning" style="width: 72%"></div>
                            </div>
                        </div>

                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="breakdown-label">
                                    <i class="bi bi-briefcase"></i> Experience Relevance
                                </span>
                                <span class="breakdown-score">85%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill success" style="width: 85%"></div>
                            </div>
                        </div>

                        <div class="breakdown-item">
                            <div class="breakdown-header">
                                <span class="breakdown-label">
                                    <i class="bi bi-file-text"></i> Format & Structure
                                </span>
                                <span class="breakdown-score">60%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill warning" style="width: 60%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="quick-stats">
                        <div class="stat-card">
                            <div class="stat-icon critical">
                                <i class="bi bi-exclamation-circle"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">5</span>
                                <span class="stat-label">Critical Issues</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon warning">
                                <i class="bi bi-exclamation-triangle"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">8</span>
                                <span class="stat-label">Warnings</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon success">
                                <i class="bi bi-check-circle"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">12</span>
                                <span class="stat-label">Matches</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Job Description Tab -->
                <div class="tab-content" id="job-tab">
                    <div class="job-description-content">
                        <div class="job-header">
                            <h3>{{ job_title|default:"Senior Software Developer" }}</h3>
                            <p class="company-name">{{ company_name|default:"Tech Solutions Ltd" }}</p>
                            <div class="job-meta">
                                <span><i class="bi bi-geo-alt"></i> Gaborone, Botswana</span>
                                <span><i class="bi bi-clock"></i> Full-time</span>
                            </div>
                        </div>

                        <div class="job-section">
                            <h4>Requirements</h4>
                            <ul class="requirements-list">
                                <li class="matched">
                                    <i class="bi bi-check-circle-fill"></i>
                                    5+ years of software development experience
                                </li>
                                <li class="matched">
                                    <i class="bi bi-check-circle-fill"></i>
                                    Proficiency in JavaScript and React
                                </li>
                                <li class="missing">
                                    <i class="bi bi-x-circle-fill"></i>
                                    Experience with Python and Django
                                </li>
                                <li class="missing">
                                    <i class="bi bi-x-circle-fill"></i>
                                    AWS or cloud platform experience
                                </li>
                                <li class="partial">
                                    <i class="bi bi-dash-circle-fill"></i>
                                    Team leadership experience
                                </li>
                            </ul>
                        </div>

                        <div class="job-section">
                            <h4>Keywords Found</h4>
                            <div class="keywords-cloud">
                                <span class="keyword found">JavaScript</span>
                                <span class="keyword found">React</span>
                                <span class="keyword found">Node.js</span>
                                <span class="keyword missing">Python</span>
                                <span class="keyword missing">Django</span>
                                <span class="keyword missing">AWS</span>
                                <span class="keyword found">CI/CD</span>
                                <span class="keyword partial">Leadership</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Improvements Tab -->
                <div class="tab-content" id="improvements-tab">
                    <div class="improvements-content">
                        <div class="improvements-header">
                            <h4>Priority Improvements</h4>
                            <p>Make these changes to increase your score</p>
                        </div>

                        <!-- Critical Improvements -->
                        <div class="improvement-group">
                            <div class="group-header critical">
                                <i class="bi bi-exclamation-circle-fill"></i>
                                <span>Critical (Fix Immediately)</span>
                            </div>

                            <div class="improvement-card" data-highlight="summary">
                                <div class="improvement-priority critical">1</div>
                                <div class="improvement-content">
                                    <h5>Add Quantifiable Achievements</h5>
                                    <p>Your summary lacks specific metrics. Add numbers like "increased sales by 30%" or "managed team of 5".</p>
                                    <div class="improvement-example">
                                        <span class="example-label">Example:</span>
                                        <p>"Led development of e-commerce platform serving <strong>10,000+ daily users</strong>"</p>
                                    </div>
                                    <button class="btn-apply" onclick="applyImprovement(this)">
                                        <i class="bi bi-magic"></i> Apply Suggestion
                                    </button>
                                </div>
                            </div>

                            <div class="improvement-card" data-highlight="skills">
                                <div class="improvement-priority critical">2</div>
                                <div class="improvement-content">
                                    <h5>Add Missing Technical Skills</h5>
                                    <p>The job requires Python and Django, but they're not on your CV.</p>
                                    <div class="improvement-tags">
                                        <span class="tag-add">+ Python</span>
                                        <span class="tag-add">+ Django</span>
                                        <span class="tag-add">+ AWS</span>
                                    </div>
                                    <button class="btn-apply" onclick="applyImprovement(this)">
                                        <i class="bi bi-magic"></i> Apply Suggestion
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Warning Improvements -->
                        <div class="improvement-group">
                            <div class="group-header warning">
                                <i class="bi bi-exclamation-triangle-fill"></i>
                                <span>Recommended</span>
                            </div>

                            <div class="improvement-card" data-highlight="experience">
                                <div class="improvement-priority warning">3</div>
                                <div class="improvement-content">
                                    <h5>Expand Leadership Experience</h5>
                                    <p>Mention specific team size and leadership responsibilities.</p>
                                    <button class="btn-apply" onclick="applyImprovement(this)">
                                        <i class="bi bi-magic"></i> Apply Suggestion
                                    </button>
                                </div>
                            </div>

                            <div class="improvement-card">
                                <div class="improvement-priority warning">4</div>
                                <div class="improvement-content">
                                    <h5>Use Action Verbs</h5>
                                    <p>Start bullet points with strong action verbs like "Architected", "Optimized", "Spearheaded".</p>
                                    <button class="btn-apply" onclick="applyImprovement(this)">
                                        <i class="bi bi-magic"></i> Apply Suggestion
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Success Items -->
                        <div class="improvement-group">
                            <div class="group-header success">
                                <i class="bi bi-check-circle-fill"></i>
                                <span>What's Working Well</span>
                            </div>

                            <div class="success-items">
                                <div class="success-item">
                                    <i class="bi bi-check"></i>
                                    <span>Relevant job title matches position</span>
                                </div>
                                <div class="success-item">
                                    <i class="bi bi-check"></i>
                                    <span>Years of experience meets requirement</span>
                                </div>
                                <div class="success-item">
                                    <i class="bi bi-check"></i>
                                    <span>Education section is complete</span>
                                </div>
                                <div class="success-item">
                                    <i class="bi bi-check"></i>
                                    <span>Contact information is clear</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Legend -->
    <div class="highlight-legend">
        <div class="legend-item">
            <span class="legend-color critical"></span>
            <span>Critical Issue</span>
        </div>
        <div class="legend-item">
            <span class="legend-color warning"></span>
            <span>Needs Attention</span>
        </div>
        <div class="legend-item">
            <span class="legend-color success"></span>
            <span>Good Match</span>
        </div>
    </div>
</div>

<!-- Tooltip for highlights -->
<div class="highlight-tooltip" id="highlightTooltip">
    <div class="tooltip-content"></div>
    <div class="tooltip-arrow"></div>
</div>

{% endblock %}

<script src="{% static 'js/cv_analysis.js' %}"></script>
</body>
</html>